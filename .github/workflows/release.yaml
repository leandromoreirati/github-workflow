name: "GitVerson Workflow"

on:
  workflow_call:
    inputs:
      versionSpec:
        required: true
        type: string
        default: '5.12.x'
      configFilePath:
        required: true
        type: string
        default: './GitVersion.yml'
      dotNetVersion:
        required: true
        type: string
        default: '3.1.x'
      runs-on:
        required: true
        type: string
        default: 'ubuntu-latest'
      environment:
        required: false
        type: string
        default: ''

jobs:
  reusable-workflow:
    runs-on: ${{ inputs.runs-on }}
    steps:
      - name: Input version of GitVertion (workflow call)
        if: ${{ inputs.versionSpec }} != ''
        run: echo ${{ inputs.versionSpec }}

      - name: Input Gitversion configuration file path.
        if: ${{ github.event.inputs.username }} != ''
        run: echo ${{ inputs.GitVersionFilePath }}

      - name: Input DotNet install Version
        if: ${{ inputs.dotNetVersion }} != ''
        run: echo ${{ inputs.versionSpec }}

      - name: Input Agent
        if: ${{ github.event.inputs.username }} != ''
        run: echo ${{ inputs.runs-on }}

      - name: Input Environtemnt
        if: ${{ inputs.environment }} != ''
        run: echo ${{ inputs.versionSpec }}

      - uses: actions/checkout@v2.3.4 # Necessary to access local action
      
      - name: Local Action Call Without Input
        id: local-action
        uses: ./.github/actions/release
        with:
          name: "World"
      - name: Local Action Output
        run: echo "${{ steps.local-action.outputs.random }}"
